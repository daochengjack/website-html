# Monorepo Workspace

This repository is a modern TypeScript monorepo prepared for full-stack development. It uses [pnpm](https://pnpm.io/) workspaces with [Turborepo](https://turbo.build/repo) to coordinate tasks across applications and shared packages.

## Getting started

### Prerequisites

- [pnpm](https://pnpm.io/) `>=8`
- Node.js 18 or newer

### Install dependencies

```bash
pnpm install
```

### Available commands

| Command           | Description                                                |
| ----------------- | ---------------------------------------------------------- |
| `pnpm dev`        | Run all applications in development mode via Turborepo     |
| `pnpm build`      | Build every package and application                        |
| `pnpm lint`       | Run linting across the workspace                           |
| `pnpm test`       | Execute placeholder test commands for each package and app |
| `pnpm db:migrate` | Run Prisma migrations against the configured PostgreSQL DB |
| `pnpm db:seed`    | Seed the database with reference data                      |
| `pnpm db:check`   | Execute database constraint sanity checks                  |

To run a single project you can `cd` into the package/app folder and run its scripts, e.g. `pnpm --filter @repo/frontend dev`.

## Project structure

```
.
├── apps
│   ├── backend      # NestJS placeholder service
│   └── frontend     # Next.js 14 application using the app router
├── packages
│   ├── config       # Shared runtime configuration helpers
│   ├── db           # Prisma ORM database layer (PostgreSQL)
│   ├── types        # Shared TypeScript types
│   └── ui           # Shared UI primitives built with React
├── docs
│   ├── csceramic-site-architecture.md
│   └── reference    # Legacy HTML snapshots kept for comparison
├── .husky           # Commit hooks (lint-staged)
├── turbo.json       # Turborepo pipeline definition
├── tsconfig.base.json
└── pnpm-workspace.yaml
```

The legacy standalone HTML that previously lived at the repository root now resides in `docs/reference/` for future reference.

## Database setup

The monorepo includes a shared database package (`@repo/db`) using Prisma ORM with PostgreSQL. See the detailed [Data Model Documentation](./docs/data-model.md) for complete schema reference.

### Prerequisites

- PostgreSQL 14+ running locally or remotely
- Configure `DATABASE_URL` environment variable

### Initial setup

1. Create `.env` file in `packages/db`:

   ```bash
   cp packages/db/.env.example packages/db/.env
   ```

2. Update `DATABASE_URL` in `.env`:

   ```
   DATABASE_URL="postgresql://user:password@localhost:5432/csceramic?schema=public"
   ```

3. Generate Prisma Client:

   ```bash
   pnpm db:generate
   ```

4. Run migrations:

   ```bash
   pnpm db:migrate
   ```

5. Seed reference data (optional):
   ```bash
   pnpm db:seed
   ```

### Additional database commands

| Command                  | Description                                     |
| ------------------------ | ----------------------------------------------- |
| `pnpm db:studio`         | Open Prisma Studio GUI at http://localhost:5555 |
| `pnpm db:reset`          | Reset database (WARNING: deletes all data)      |
| `pnpm db:migrate:deploy` | Apply migrations in production                  |

For detailed package-level documentation, see [packages/db/README.md](./packages/db/README.md).

## Commit hooks

[Husky](https://typicode.github.io/husky) and [lint-staged](https://github.com/lint-staged/lint-staged) are configured to format and lint staged files before each commit. Hooks are installed automatically when you run `pnpm install`.

## Notes

- Turborepo caching is configured for build artifacts generated by the frontend, backend, and shared packages.
- Shared TypeScript path aliases are defined in `tsconfig.base.json` and can be used across the workspace (e.g. `@repo/types`).
